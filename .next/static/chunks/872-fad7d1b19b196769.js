"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[872],{1872:(e,a,s)=>{s.d(a,{default:()=>b});var t=s(5155),r=s(2115),l=s(6874),n=s.n(l),o=s(5695),i=s(3783),d=s(5525),c=s(4131),u=s(5670),m=s(7924),h=s(5937),x=s(381),g=s(7108),p=s(1007),f=s(4835),v=s(7809),w=s(8543);let N=()=>{let[e,a]=(0,r.useState)(null),[s,t]=(0,r.useState)(null),[l,n]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{let e=()=>{try{let e=localStorage.getItem("token"),s=localStorage.getItem("user");if(e&&s){let r=JSON.parse(s);a(r),t(e)}else a(null),t(null)}catch(e){console.error("Error parsing stored auth data:",e),localStorage.removeItem("token"),localStorage.removeItem("user"),a(null),t(null)}n(!1)};e();let s=a=>{("token"===a.key||"user"===a.key)&&e()};window.addEventListener("storage",s);let r=()=>{e()};return window.addEventListener("authStateChanged",r),()=>{window.removeEventListener("storage",s),window.removeEventListener("authStateChanged",r)}},[]),{user:e,token:s,loading:l,isAuthenticated:!!e&&!!s,logout:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),a(null),t(null),window.dispatchEvent(new Event("authStateChanged"))},updateUser:(e,s)=>{a(e),localStorage.setItem("user",JSON.stringify(e)),s&&(t(s),localStorage.setItem("token",s)),window.dispatchEvent(new Event("authStateChanged"))}}};function b(){var e,a,s,l;let[b,j]=(0,r.useState)(""),{user:y,loading:S,isAuthenticated:A,logout:E}=N(),R=(0,o.usePathname)(),I=(0,o.useRouter)(),U=null!=(e=null==R?void 0:R.startsWith("/dashboard"))&&e,k=null!=(a=null==R?void 0:R.startsWith("/admin-dashboard"))&&a,O=null!=(s=null==R?void 0:R.startsWith("/warehouse-dashboard"))&&s,T=null!=(l=null==R?void 0:R.startsWith("/buyer-dashboard"))&&l,W=U||k||O||T,L=async()=>{try{E(),w.oR.success("You have been logged out successfully"),I.push("/")}catch(e){console.error("Error signing out:",e),w.oR.error("Error logging out")}},Y=()=>{if(!y)return"Dashboard";switch(y.role){case"ADMINISTRATOR":return"Admin Panel";case"WAREHOUSE_GUY":return"Warehouse";case"BUYER":return"Buyer Panel";default:return"Dashboard"}};return S?(0,t.jsx)("nav",{className:"sticky top-0 z-50 w-full bg-white border-b border-gray-200 px-6 py-6 shadow-lg",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[(0,t.jsx)("div",{className:"w-32 h-6 bg-gray-200 rounded animate-pulse"}),(0,t.jsx)("div",{className:"w-64 h-8 bg-gray-200 rounded animate-pulse"}),(0,t.jsx)("div",{className:"w-24 h-6 bg-gray-200 rounded animate-pulse"})]})}):(0,t.jsxs)("nav",{className:"sticky top-0 z-50 w-full bg-white border-b border-gray-200 px-3 py-3 shadow-lg",children:[(0,t.jsxs)("div",{className:"max-w-7xl mx-auto flex flex-wrap items-center justify-between gap-4",children:[(0,t.jsxs)(n(),{href:"/",className:"flex items-center space-x-2",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-green-400 to-teal-500 rounded-md flex items-center justify-center shadow-md",children:(0,t.jsx)("span",{className:"text-white font-bold text-lg",children:"N"})}),(0,t.jsx)("span",{className:"text-xl font-bold text-gray-800",children:"NERATION"})]}),!W||T?(0,t.jsx)("div",{className:"flex-1 max-w-2xl mx-auto w-full",children:(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),b.trim()&&(T?I.push("/marketplace/search?q=".concat(encodeURIComponent(b))):I.push("/search?q=".concat(encodeURIComponent(b))),console.log("Search query:",b))},className:"relative flex",role:"search",children:[(0,t.jsx)("input",{type:"text",value:b,onChange:e=>j(e.target.value),placeholder:T?"Search marketplace...":"Search products...",className:"w-full px-5 py-3 text-sm text-gray-700 bg-gray-100 border border-gray-300 rounded-l-full focus:outline-none focus:ring-2 focus:ring-teal-500 shadow-sm","aria-label":"Search"}),(0,t.jsx)("button",{type:"submit",className:"px-6 py-3 bg-teal-500 text-white rounded-r-full hover:bg-teal-600 transition shadow-md hover:shadow-lg","aria-label":"Submit search",children:(0,t.jsx)(m.A,{className:"w-5 h-5"})})]})}):(0,t.jsx)("div",{className:"flex-1"}),(0,t.jsxs)("div",{className:"flex items-center space-x-4 text-sm",children:[A?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n(),{href:W?"/":(()=>{if(!y)return"/dashboard";switch(y.role){case"ADMINISTRATOR":return"/admin-dashboard";case"WAREHOUSE_GUY":return"/warehouse-dashboard";case"BUYER":return"/buyer-dashboard";default:return"/dashboard"}})(),className:"flex items-center space-x-2 text-gray-700 hover:text-teal-600 transition-colors px-3 py-2 rounded-lg hover:bg-gray-50 hover:shadow-sm","aria-label":W?"Go to marketplace":"Go to ".concat(Y()),children:[W?(0,t.jsx)(h.A,{className:"w-5 h-5"}):(()=>{if(!y)return(0,t.jsx)(i.A,{className:"w-5 h-5"});switch(y.role){case"ADMINISTRATOR":return(0,t.jsx)(d.A,{className:"w-5 h-5"});case"WAREHOUSE_GUY":return(0,t.jsx)(c.A,{className:"w-5 h-5"});case"BUYER":return(0,t.jsx)(u.A,{className:"w-5 h-5"});default:return(0,t.jsx)(i.A,{className:"w-5 h-5"})}})(),(0,t.jsx)("span",{className:"font-medium hidden sm:inline",children:W?"Marketplace":Y()})]}),(null==y?void 0:y.role)==="ADMINISTRATOR"&&(0,t.jsxs)(n(),{href:"/admin/settings",className:"flex items-center space-x-2 text-gray-700 hover:text-teal-600 transition-colors px-3 py-2 rounded-lg hover:bg-gray-50 hover:shadow-sm",title:"Settings",children:[(0,t.jsx)(x.A,{className:"w-5 h-5"}),(0,t.jsx)("span",{className:"font-medium hidden lg:inline",children:"Settings"})]}),(null==y?void 0:y.role)==="WAREHOUSE_GUY"&&(0,t.jsxs)(n(),{href:"/warehouse/inventory",className:"flex items-center space-x-2 text-gray-700 hover:text-teal-600 transition-colors px-3 py-2 rounded-lg hover:bg-gray-50 hover:shadow-sm",title:"Inventory",children:[(0,t.jsx)(g.A,{className:"w-5 h-5"}),(0,t.jsx)("span",{className:"font-medium hidden lg:inline",children:"Inventory"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3 text-gray-700",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 max-w-[200px] truncate px-2 py-1 rounded-lg",children:[(0,t.jsx)("div",{className:"w-9 h-9 bg-gradient-to-br ".concat((()=>{if(!y)return"from-teal-400 to-teal-600";switch(y.role){case"ADMINISTRATOR":return"from-red-400 to-red-600";case"WAREHOUSE_GUY":return"from-orange-400 to-orange-600";case"BUYER":return"from-blue-400 to-blue-600";case"FARMER":return"from-green-400 to-green-600";case"SELLER":return"from-purple-400 to-purple-600";default:return"from-teal-400 to-teal-600"}})()," rounded-full flex items-center justify-center shadow-md"),children:(0,t.jsx)(p.A,{className:"w-4 h-4 text-white"})}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"font-medium truncate text-sm",children:(null==y?void 0:y.firstName)&&(null==y?void 0:y.lastName)?"".concat(y.firstName," ").concat(y.lastName):(null==y?void 0:y.displayName)?y.displayName:(null==y?void 0:y.email)?y.email.split("@")[0]:"User"}),(null==y?void 0:y.role)&&(0,t.jsx)("span",{className:"text-xs text-gray-500 uppercase tracking-wide",children:y.role.replace("_"," ")})]})]}),(0,t.jsxs)("button",{onClick:L,className:"flex items-center space-x-1 px-3 py-2 text-red-600 hover:text-red-700 hover:bg-red-50 rounded-md transition-colors shadow-sm hover:shadow-md",title:"Logout","aria-label":"Logout",children:[(0,t.jsx)(f.A,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"text-xs font-medium hidden sm:inline",children:"Logout"})]})]})]}):(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 hover:shadow-sm transition-all",children:[(0,t.jsx)(p.A,{className:"w-5 h-5"}),(0,t.jsx)(n(),{href:"/login",className:"font-medium hover:underline","aria-label":"Login",children:"Login"}),(0,t.jsx)("span",{className:"text-gray-400",children:"|"}),(0,t.jsx)(n(),{href:"/signup/farmer",className:"font-medium hover:underline","aria-label":"Register",children:"Register"})]}),!k&&!O&&(!W||T)&&(0,t.jsxs)("div",{className:"relative cursor-pointer group p-2 rounded-lg hover:bg-gray-50 hover:shadow-sm transition-all","aria-label":"Shopping cart",children:[(0,t.jsx)(v.A,{className:"w-6 h-6 text-gray-600 group-hover:text-gray-800 transition"}),(0,t.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs font-semibold rounded-full w-5 h-5 flex items-center justify-center shadow-md",children:"0"})]})]})]}),(null==y?void 0:y.role)==="ADMINISTRATOR"&&k&&(0,t.jsx)("div",{className:"bg-red-50 border-t border-red-200 px-4 py-2",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto flex items-center space-x-2 text-red-700 text-sm",children:[(0,t.jsx)(d.A,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Administrator Mode - Full System Access"})]})}),(null==y?void 0:y.role)==="WAREHOUSE_GUY"&&O&&(0,t.jsx)("div",{className:"bg-orange-50 border-t border-orange-200 px-4 py-2",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto flex items-center space-x-2 text-orange-700 text-sm",children:[(0,t.jsx)(c.A,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Warehouse Management - Inventory & Orders"})]})})]})}}}]);